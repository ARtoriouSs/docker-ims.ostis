# Dockerized ims.ostis

Это инструкция по запску локального сервера ims.ostis в Docker контейнере.

Такой способ позволяет одной командой запускать сервер на любой операционной системе и не требует локальной установки проекта, при этом гораздо проще манипулировать несколькими базами или запускать их параллельно. Шанс появления проблем с запуском сервера сводится к минимуму, так как он происходит в заранее подготовленном изолированном контейнере.

## Установка и запуск

**Шаг 0**

Установить Docker:

* [Для Linux](https://www.digitalocean.com/community/tutorials/docker-ubuntu-16-04-ru "Установка Docker на Ubuntu")
* [Для macOS](https://docs.docker.com/docker-for-mac/install/ "Установка Docker на macOS")
* [Для Windows 10](https://hub.docker.com/editions/community/docker-ce-desktop-windows "Установка Docker на Windows 10") или [для Windows < 10](https://docs.docker.com/toolbox/overview/ "Установка Docker на Windows < 10")

При установке на Windows может потребоваться включить виртуализацию в биосе. Так же для Windows лучше использовать bash эмулятор, например [GitBash](https://gitforwindows.org/ "GitBash"). В CMD или PowerShell тоже можно. Но не нужно :)

**Шаг 1**

Склонировать этот репозиторий:
```bash
git clone https://github.com/ARtoriouSs/docker-ims.ostis.git
cd docker-ims.ostis
```

**Шаг 2**

Запустить run.sh:
```bash
./run.sh /путь/к/папке/с/базой [--noupdate] [--port=$port]
```
/путь/к/папке/с/базой это относительный или абсолютный путь к папке где лежат все файлы которые должны быть в базе. Скорее всего это будет что-то вроде ostis/kb. --noupdate это _необязательный_ аргумент, который предотвратит обновление репозиториев при сборке контейнера. Его стоит использовать если в репозитории системы попали нерабочие изменения. Состояние репозиториев образа можно найти [здесь](https://github.com/ARtoriouSs/docker-ims.ostis/blob/master/versions.md "Состояние репозиториев"). --port= это _необязательный_ аргумент который принимает значение порта который будет слушать сервер, например если выполнить ```./run.sh ostis/kb --port=7000```, то сервер будет доступен на localhost:7000. По стандарту используется порт 8000.

Чтобы выключить сервер нужно нажать ctrl + C или то ctrl + Z.

После этого можно внести изменения в базу и повторить шаг 2.

**Дополнительно**

Скрипт clean.sh удаляет все оставшиеся контейнеры. Это почти полностью выполняется в начале run.sh, так что при каждом новом запуске всё лишнее будет удаляться, но в самом конце развлечений лучше сделать дополнительно:
```bash
./clean.sh
```

Также можно посмотреть содержимое kb в уже собранной и запущенной системе, например чтобы убедиться что в контейнер попали правильные файлы. Для этого после запуска run.sh в новой вкладке:
```bash
./show_kb.sh
```

Все найденные проблемы и их возможные решения будут [тут](https://github.com/ARtoriouSs/docker-ims.ostis/blob/master/troubleshooting.md "Расстрел проблем").

**P.S.** Идейный вдохновитель [Маша](https://github.com/idealasgas "GitHub Маши") :)
